<h2>Hotel Results</h2>

<!-- Display the search criteria -->
<div id="search-criteria" class="container">
  <div class="row">
    <div class="col-md-12">
      <h2>Search Criteria</h2>
    </div><!-- col-md-12 -->
  </div><!-- row -->
  <div class="row">
    <div class="col-md-4">
      <p> City: <%= @search_hotel.city %></p>
    </div><!-- col-md-4 -->
    <div class="col-md-4">
      <p> Star Rating: <%= @search_hotel.min_star_rating %> - <%= @search_hotel.max_star_rating %></p>
    </div><!-- col-md-4 -->
    <div class="col-md-4">
      <p> Daily Nightly Rate: <%= @search_hotel.min_daily_rate %> - <%= @search_hotel.max_daily_rate %></p>
    </div><!-- col-md-4 -->
  </div><!-- row -->

  <div class="row">
    <div class="col-md-12">
      <div class="filter" data-label="Show: ">
        <ul>
          <li class="active"><a href="#" data-filter="*">All</a></li>
          <li><a href="#" data-filter=".deals">Deals</a></li>
        </ul>
      </div><!-- filter -->
    </div><!-- col-md-12 -->
  </div><!-- row -->
</div><!-- search-criteria -->

<div id="search-results" class="container">
  <div id="accordion" class="row">
    <% @search_hotel.hotel_results.each_with_index do |hotel_result, index| %>
      <!-- Check to see if hotel star rating is within search criteria -->
      <% if (hotel_result.hotel_star_rating >= @search_hotel.min_star_rating && hotel_result.hotel_star_rating <= @search_hotel.max_star_rating) %>
        <!-- Check to see if hotel daily rate is within search criteria -->
        <% if (hotel_result.original_rate >= @search_hotel.min_daily_rate && hotel_result.original_rate <= @search_hotel.max_daily_rate) %>
          <div class="cta">
            <div class="cta-inner">
              <div class="col-text">

                <!-- Display hotel photo -->
                <div class="col-md-2 hotel-photo">
                  <img src='<%= hotel_result.image_url %>'>
                </div><!-- col-md-2 -->

                <!-- Display hotel name, star rating and a show details button -->
                <div class="col-md-8">
                  <h3 class="headline"><%= hotel_result.name %></h3>
                  <span class="stars">
                    <%= hotel_result.hotel_star_rating %>
                  </span>
                  <a data-toggle="collapse" data-parent="#accordion" href="#collapse<%= index.to_s %>">
                    Show Details
                  </a>
                </div><!-- col-md-8 -->

                <!-- Display hotel original price and promo price if applicable -->
                <div class="col-md-2">
                  <% if (hotel_result.promo_amount != 0.0) %>
                    <div class="deal-text">DEAL!</div>
                    <div class="glyphicon glyphicon-usd original-price">
                      <%= hotel_result.original_rate.round %>
                    </div>
                    <div class="glyphicon glyphicon-usd">
                      <%= hotel_result.promo_rate.round %>
                    </div>
                  <% else %>
                    <div class="glyphicon glyphicon-usd">
                      <%= hotel_result.original_rate.round %>
                    </div>
                  <% end %>
                </div><!-- col-md-2 -->

                <div class="clearfix"></div>

                <div id="collapse<%= index.to_s %>" class="panel-collapse collapse">
                  <div class="panel-body">
                    <div class="col-md-2"></div>

                    <!-- Additional hotel information to be shown after the Show Details link is clicked -->
                    <div class="col-md-8">
                      <p>Description: <%= hotel_result.hotel_description %></p>
                      <p>Minimum length of stay: <%= hotel_result.length_of_stay %></p>
                      <p class="glyphicon glyphicon-calendar"></p>Check In Date: <%= hotel_result.check_in_date %>
                      <p class="glyphicon glyphicon-calendar"></p>Check Out Date: <%= hotel_result.check_out_date %>
                      <div id="button" class="col-btn">
                        <a class="btn btn-md btn-success">Book it!</a>
                      </div><!-- button -->
                    </div><!-- col-md-8 -->

                    <!-- Display static google map of hotel location -->
                    <div class="col-md-2">
                      <img src='http://maps.googleapis.com/maps/api/staticmap?markers=<%= hotel_result.hotel_latitude %>,<%= hotel_result.hotel_longitude %>&zoom=11&size=150x150&sensor=false'>
                    </div><!-- col-md-2 -->
                  </div><!-- panel-body -->
                </div><!-- panel-collapse -->

              </div><!-- col-text -->
            </div><!-- cta-inner -->
          </div><!-- cta -->
        <% end %>
      <% end %>
    <% end %>
  </div><!-- row -->
</div><!-- search-results -->


<!-- Display stars instead of numerical values -->
<script>
  $(function() {
      $('span.stars').stars();
  });
</script>












